<div class="configure-corosync detail-panel diff" ng-class="{ saving: corosync.saving }" ng-form="form" ng-if="corosync.config">
  <h4 class="section-header">Corosync Configuration</h4>

  <div ng-if="corosync.saving" class="alert alert-info">
    Saving <i class="fa fa-spinner fa-spin"></i>
  </div>

  <div class="detail-row">
    <div>Mcast Port:</div>
    <div ng-if="!corosync.editable">{{ corosync.config.mcast_port }}</div>
    <div ng-if="corosync.editable" ng-class="corosync.diff(corosync.config).type">
      <input name="mcastPort" type="number" min="1" max="65536" required ng-model="corosync.config.mcast_port" class="form-control" />
      <iml-tooltip class="error-tooltip" toggle="form.mcastPort.$invalid" direction="bottom">
        <span ng-if="form.mcastPort.$error.max">Mcast Port must be less than or equal to 65536.</span>
        <span ng-if="form.mcastPort.$error.min">Mcast Port must be greater than or equal to 1.</span>
        <span ng-if="form.mcastPort.$error.number">Mcast Port must be a number.</span>
        <span ng-if="form.mcastPort.$error.required">Mcast Port is required.</span>
      </iml-tooltip>
      <a class="clean-record"
         ng-if="corosync.diff(corosync.config).type"
         ng-click="corosync.reset(corosync.config)"
         tooltip-placement="left"
         tooltip="{{ corosync.diff(corosync.config).type + '_diff' | insertHelp : corosync.diff(corosync.config).diff }}">
        <i class="fa fa-times-circle"></i>
      </a>
    </div>
  </div>

  <div class="detail-row">
    <div>State:</div>
    <div>
      <corosync-state stream="corosync.stream"></corosync-state>
    </div>
  </div>

  <div class="detail-row">
    <div>Alerts:</div>
    <div>
      <record-state record-id="corosync.config.resource_uri" alert-stream="corosync.alertStream" display-type="'medium'"></record-state>
      <job-status record-id="corosync.config.resource_uri" job-stream="corosync.jobStream"></job-status>
    </div>
  </div>

  <div class="configure-btns" ng-if="!corosync.editable" as-stream val="corosync.config">
    <action-dropdown tooltip-placement="top" stream="::str"></action-dropdown>

    <button class="btn btn-primary btn-block btn-sm edit-btn" ng-click="corosync.setEditable(true)">
      Configure<i class="fa fa-gear"></i>
    </button>
  </div>

  <div ng-if="corosync.editable" class="save-btns">
    <div class="save-button btn-group block-dropdown" dropdown>
      <button type="button" ng-click="corosync.save()" class="btn btn-success" ng-disabled="corosync.saving || !corosync.diff(corosync.config).type || form.mcastPort.$invalid">
        Save<i class="fa" ng-class="{'fa-spinner fa-spin': configureCorosync.saving, 'fa-check-circle-o': !configureCorosync.saving }"></i>
      </button>

      <button type="button" class="btn btn-success dropdown-toggle" dropdown-toggle ng-disabled="corosync.saving || !corosync.diff(corosync.config).type || form.mcastPort.$invalid">
        <span class="caret"></span>
      </button>

      <ul class="dropdown-menu btn-block" role="menu">
        <li>
          <a ng-click="corosync.save(true)">Save and skip command view</a>
        </li>
      </ul>
    </div>

    <button class="btn btn-cancel btn-block" ng-click="corosync.setEditable(false)">
      Cancel<i class="fa fa-times-circle-o"></i>
    </button>
  </div>
</div>

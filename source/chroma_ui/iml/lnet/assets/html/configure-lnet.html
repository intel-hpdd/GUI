<div class="configure-lnet detail-panel diff">
  <h4 class="section-header">NID Configuration</h4>

  <div ng-if="activeFsMember" class="alert alert-info">
    <i class="fa fa-info-circle"></i> To edit this NID configuration, ensure this host is not a member of an active file system.
  </div>
  <div ng-if="configureLnet.saving" class="alert alert-info">
    Saving <i class="fa fa-spinner fa-spin"></i>
  </div>

  <div class="detail-row config-header">
    <div>Interface</div>
    <div>IP Address</div>
    <div>Lustre Network Driver</div>
    <div>Lustre Network</div>
  </div>
  <div class="detail-row" ng-repeat="networkInterface in configureLnet.networkInterfaces | orderBy:'name' track by networkInterface.id">
    <div>{{ networkInterface.name }}</div>
    <div>{{ networkInterface.inet4_address }}</div>
    <div ng-if="activeFsMember || !configureLnet.editable">{{ networkInterface.nid.lnd_type }}</div>
    <div ng-if="!activeFsMember && configureLnet.editable" ng-class="configureLnet.diff(networkInterface).lndType.type">
      <select
        class="form-control"
        ng-model="networkInterface.nid.lnd_type"
        ng-options="type for type in networkInterface.lnd_types"
        ></select>
      <a ng-if="configureLnet.diff(networkInterface).lndType.type"
         class="clean-record"
         ng-click="configureLnet.cleanLnd(networkInterface)"
         tooltip="{{ configureLnet.diff(networkInterface).lndType.type + '_diff' | insertHelp : configureLnet.diff(networkInterface).lndType.diff }}">
        <i class="fa fa-times-circle"></i>
      </a>
    </div>

    <div ng-if="activeFsMember || !configureLnet.editable">{{ configureLnet.getOptionName(networkInterface) }}</div>
    <div ng-if="!activeFsMember && configureLnet.editable" ng-class="configureLnet.diff(networkInterface).lndNetwork.type">
      <select
        class="form-control"
        ng-model="networkInterface.nid.lnd_network"
        ng-options="option.value as option.name for option in configureLnet.options | removeUsedLnetOptions:configureLnet.networkInterfaces:networkInterface"
        ></select>
      <a ng-if="configureLnet.diff(networkInterface).lndNetwork.type"
         class="clean-record"
         ng-click="configureLnet.cleanLn(networkInterface)"
         tooltip-placement="left"
         tooltip="{{ configureLnet.diff(networkInterface).lndNetwork.type + '_diff' | insertHelp : configureLnet.diff(networkInterface).lndNetwork.diff }}">
        <i class="fa fa-times-circle"></i>
      </a>
    </div>
  </div>

  <div class="configure-btns" ng-if="!configureLnet.editable && !activeFsMember">
    <button class="btn btn-primary btn-block btn-sm edit-btn" ng-click="configureLnet.setEditable(true)">
      Configure<i class="fa fa-gear"></i>
    </button>
  </div>

  <div ng-if="!activeFsMember && configureLnet.editable" class="save-btns">
    <div class="save-button btn-group block-dropdown" dropdown>
      <button type="button" ng-click="configureLnet.save()" class="btn btn-success" ng-disabled="configureLnet.saving || !configureLnet.isDirty()">
        Save<i class="fa" ng-class="{'fa-spinner fa-spin': configureLnet.message, 'fa-check-circle-o': !configureLnet.message }"></i>
      </button>

      <button type="button" class="btn btn-success dropdown-toggle" dropdown-toggle ng-disabled="configureLnet.saving || !configureLnet.isDirty()">
        <span class="caret"></span>
      </button>

      <ul class="dropdown-menu btn-block" role="menu">
        <li>
          <a ng-click="configureLnet.save(true)">Save and skip command view</a>
        </li>
      </ul>
    </div>

    <button class="btn btn-cancel btn-block" ng-click="configureLnet.setEditable(false)">
      Cancel<i class="fa fa-times-circle-o"></i>
    </button>
  </div>
</div>
